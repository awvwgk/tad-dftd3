# This file is part of tad-dftd3.
# SPDX-Identifier: Apache-2.0
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
"""
Collection of test samples.
"""
from __future__ import annotations

import torch

from tad_dftd3.typing import Molecule, Tensor, TypedDict

from .molecules import merge_nested_dicts, mols


class Refs(TypedDict):
    """Format of reference values."""

    cn: Tensor
    """Coordination number."""

    weights: Tensor
    """Weights for atomic reference systems."""

    c6: Tensor
    """C6 coefficients."""

    disp2: Tensor
    """Two-body dispersion energy."""

    disp3: Tensor
    """Three-body (ATM) dispersion energy."""


class Record(Molecule, Refs):
    """Store for molecular information and reference values."""


refs: dict[str, Refs] = {
    "SiH4": {
        "cn": torch.tensor([], dtype=torch.float64),
        "weights": torch.tensor([], dtype=torch.float64),
        "c6": torch.tensor(
            [
                [
                    +1.5143515266127659e02,
                    +2.1399994940183870e01,
                    +2.1399994940183870e01,
                    +2.1399994940183870e01,
                    +2.1399994940183870e01,
                ],
                [
                    +2.1399994940183870e01,
                    +3.1044421868246386e00,
                    +3.1044421868246386e00,
                    +3.1044421868246386e00,
                    +3.1044421868246386e00,
                ],
                [
                    +2.1399994940183870e01,
                    +3.1044421868246386e00,
                    +3.1044421868246386e00,
                    +3.1044421868246386e00,
                    +3.1044421868246386e00,
                ],
                [
                    +2.1399994940183870e01,
                    +3.1044421868246386e00,
                    +3.1044421868246386e00,
                    +3.1044421868246386e00,
                    +3.1044421868246386e00,
                ],
                [
                    +2.1399994940183870e01,
                    +3.1044421868246386e00,
                    +3.1044421868246386e00,
                    +3.1044421868246386e00,
                    +3.1044421868246386e00,
                ],
            ],
            dtype=torch.float64,
        ),
        "disp2": torch.tensor(
            [
                -9.2481575005393872e-004,
                -3.6494949521315417e-004,
                -3.6494949521315417e-004,
                -3.6494949521315417e-004,
                -3.6494949521315417e-004,
            ],
            dtype=torch.float64,
        ),
        "disp3": torch.tensor(
            [
                -9.2481446570860746e-004,
                -3.6487414688948653e-004,
                -3.6487414688948653e-004,
                -3.6487414688948653e-004,
                -3.6487414688948653e-004,
            ],
            dtype=torch.float64,
        ),
    },
    "MB16_43_01": {
        "cn": torch.tensor([], dtype=torch.float64),
        "weights": torch.tensor([], dtype=torch.float64),
        "c6": torch.tensor(
            [
                [
                    +1.8610520000029464e02,
                    +2.1063796744395177e01,
                    +3.3339320585166313e01,
                    +2.0764888502859637e01,
                    +2.5046287981164049e01,
                    +2.0998866295774970e01,
                    +2.0763542039740727e01,
                    +3.3346936579300419e01,
                    +4.4492523776505593e01,
                    +2.0950294893274318e01,
                    +2.0993378921510811e01,
                    +1.1198290743014189e02,
                    +6.3812331616732905e01,
                    +6.4526383874592426e01,
                    +4.4492456101218266e01,
                    +1.6065940000253829e02,
                ],
                [
                    +2.1063796744395177e01,
                    +3.1010459790784366e00,
                    +5.4410412853789456e00,
                    +3.0646055302224697e00,
                    +4.3233479053021808e00,
                    +3.0931301896710095e00,
                    +3.0644413804480473e00,
                    +5.4421300659361096e00,
                    +6.8527822218114354e00,
                    +3.0872087614106349e00,
                    +3.0924612138669323e00,
                    +1.6726031405811415e01,
                    +9.3223261554621661e00,
                    +9.4096439159226630e00,
                    +6.8527726889364917e00,
                    +2.1339034898526190e01,
                ],
                [
                    +3.3339320585166313e01,
                    +5.4410412853789456e00,
                    +1.0406066221115424e01,
                    +5.3839509662148721e00,
                    +8.5733540606813623e00,
                    +5.4286398205810817e00,
                    +5.3836937969618388e00,
                    +1.0407842024168012e01,
                    +1.2630660979729793e01,
                    +5.4193628703813692e00,
                    +5.4275917532996170e00,
                    +2.9739827367705463e01,
                    +1.6331187721117576e01,
                    +1.6466491988340923e01,
                    +1.2630645307393705e01,
                    +3.5536202639031508e01,
                ],
                [
                    +2.0764888502859637e01,
                    +3.0646055302224697e00,
                    +5.3839509662148721e00,
                    +3.0286685860432869e00,
                    +4.2805167411083094e00,
                    +3.0567991147967635e00,
                    +3.0285067043578073e00,
                    +5.3850262365259995e00,
                    +6.7767014218181254e00,
                    +3.0509595040473121e00,
                    +3.0561393823597847e00,
                    +1.6532600172034343e01,
                    +9.2122201330286924e00,
                    +9.2983254462113578e00,
                    +6.7766920084643942e00,
                    +2.1065882917937291e01,
                ],
                [
                    +2.5046287981164049e01,
                    +4.3233479053021808e00,
                    +8.5733540606813623e00,
                    +4.2805167411083094e00,
                    +7.1651016761294581e00,
                    +4.3140438904923277e00,
                    +4.2803238036950395e00,
                    +8.5747145042947057e00,
                    +1.0247621930816463e01,
                    +4.3070839963624605e00,
                    +4.3132575935776156e00,
                    +2.3771627205176628e01,
                    +1.2966152414455200e01,
                    +1.3067160653787596e01,
                    +1.0247609834586852e01,
                    +2.7531712923577373e01,
                ],
                [
                    +2.0998866295774970e01,
                    +3.0931301896710095e00,
                    +5.4286398205810817e00,
                    +3.0567991147967635e00,
                    +4.3140438904923277e00,
                    +3.0852381590654949e00,
                    +3.0566354577087651e00,
                    +5.4297256663702678e00,
                    +6.8362555430903251e00,
                    +3.0793345036429041e00,
                    +3.0845711911551086e00,
                    +1.6684013237554208e01,
                    +9.2984083357471086e00,
                    +9.3854627219183140e00,
                    +6.8362460361784185e00,
                    +2.1279699362811201e01,
                ],
                [
                    +2.0763542039740727e01,
                    +3.0644413804480473e00,
                    +5.3836937969618388e00,
                    +3.0285067043578073e00,
                    +4.2803238036950395e00,
                    +3.0566354577087651e00,
                    +3.0283448328891693e00,
                    +5.3847690064146647e00,
                    +6.7763587079781784e00,
                    +3.0507962155147617e00,
                    +3.0559757669094898e00,
                    +1.6531728841016545e01,
                    +9.2117241490517525e00,
                    +9.2978240006401354e00,
                    +6.7763492951628441e00,
                    +2.1064652476562269e01,
                ],
                [
                    +3.3346936579300419e01,
                    +5.4421300659361096e00,
                    +1.0407842024168012e01,
                    +5.3850262365259995e00,
                    +8.5747145042947057e00,
                    +5.4297256663702678e00,
                    +5.3847690064146647e00,
                    +1.0409618281941672e01,
                    +1.2632967523797989e01,
                    +5.4204465208092127e00,
                    +5.4286773510669475e00,
                    +2.9745623334829297e01,
                    +1.6334454742258295e01,
                    +1.6469791682933668e01,
                    +1.2632951847954342e01,
                    +3.5543847001798589e01,
                ],
                [
                    +4.4492523776505593e01,
                    +6.8527822218114354e00,
                    +1.2630660979729793e01,
                    +6.7767014218181254e00,
                    +1.0247621930816463e01,
                    +6.8362555430903251e00,
                    +6.7763587079781784e00,
                    +1.2632967523797989e01,
                    +1.5581774213954880e01,
                    +6.8238927151533533e00,
                    +6.8348588474966023e00,
                    +3.7238195769630941e01,
                    +2.0588660470055050e01,
                    +2.0769748335077804e01,
                    +1.5581753925537958e01,
                    +4.5940023755619407e01,
                ],
                [
                    +2.0950294893274318e01,
                    +3.0872087614106349e00,
                    +5.4193628703813692e00,
                    +3.0509595040473121e00,
                    +4.3070839963624605e00,
                    +3.0793345036429041e00,
                    +3.0507962155147617e00,
                    +5.4204465208092127e00,
                    +6.8238927151533533e00,
                    +3.0734441432410002e00,
                    +3.0786690377429728e00,
                    +1.6652581430041241e01,
                    +9.2805165442532100e00,
                    +9.3673739125555198e00,
                    +6.8238832276631696e00,
                    +2.1235313250454865e01,
                ],
                [
                    +2.0993378921510811e01,
                    +3.0924612138669323e00,
                    +5.4275917532996170e00,
                    +3.0561393823597847e00,
                    +4.3132575935776156e00,
                    +3.0845711911551086e00,
                    +3.0559757669094898e00,
                    +5.4286773510669475e00,
                    +6.8348588474966023e00,
                    +3.0786690377429728e00,
                    +3.0839043929349748e00,
                    +1.6680462216114787e01,
                    +9.2963870032113221e00,
                    +9.3834191312073933e00,
                    +6.8348493427788748e00,
                    +2.1274684823430196e01,
                ],
                [
                    +1.1198290743014189e02,
                    +1.6726031405811415e01,
                    +2.9739827367705463e01,
                    +1.6532600172034343e01,
                    +2.3771627205176628e01,
                    +1.6684013237554208e01,
                    +1.6531728841016545e01,
                    +2.9745623334829297e01,
                    +3.7238195769630941e01,
                    +1.6652581430041241e01,
                    +1.6680462216114787e01,
                    +9.0398512850663536e01,
                    +5.0270824073272344e01,
                    +5.0733661557241589e01,
                    +3.7238144827380552e01,
                    +1.1424050806247331e02,
                ],
                [
                    +6.3812331616732905e01,
                    +9.3223261554621661e00,
                    +1.6331187721117576e01,
                    +9.2122201330286924e00,
                    +1.2966152414455200e01,
                    +9.2984083357471086e00,
                    +9.2117241490517525e00,
                    +1.6334454742258295e01,
                    +2.0588660470055050e01,
                    +9.2805165442532100e00,
                    +9.2963870032113221e00,
                    +5.0270824073272344e01,
                    +2.8031523361167238e01,
                    +2.8295323355380670e01,
                    +2.0588631791805902e01,
                    +6.4333229043156891e01,
                ],
                [
                    +6.4526383874592426e01,
                    +9.4096439159226630e00,
                    +1.6466491988340923e01,
                    +9.2983254462113578e00,
                    +1.3067160653787596e01,
                    +9.3854627219183140e00,
                    +9.2978240006401354e00,
                    +1.6469791682933668e01,
                    +2.0769748335077804e01,
                    +9.3673739125555198e00,
                    +9.3834191312073933e00,
                    +5.0733661557241589e01,
                    +2.8295323355380670e01,
                    +2.8562048915200840e01,
                    +2.0769719368098251e01,
                    +6.4989138522417647e01,
                ],
                [
                    +4.4492456101218266e01,
                    +6.8527726889364917e00,
                    +1.2630645307393705e01,
                    +6.7766920084643942e00,
                    +1.0247609834586852e01,
                    +6.8362460361784185e00,
                    +6.7763492951628441e00,
                    +1.2632951847954342e01,
                    +1.5581753925537958e01,
                    +6.8238832276631696e00,
                    +6.8348493427788748e00,
                    +3.7238144827380552e01,
                    +2.0588631791805902e01,
                    +2.0769719368098251e01,
                    +1.5581733637151791e01,
                    +4.5939956092009751e01,
                ],
                [
                    +1.6065940000253829e02,
                    +2.1339034898526190e01,
                    +3.5536202639031508e01,
                    +2.1065882917937291e01,
                    +2.7531712923577373e01,
                    +2.1279699362811201e01,
                    +2.1064652476562269e01,
                    +3.5543847001798589e01,
                    +4.5940023755619407e01,
                    +2.1235313250454865e01,
                    +2.1274684823430196e01,
                    +1.1424050806247331e02,
                    +6.4333229043156891e01,
                    +6.4989138522417647e01,
                    +4.5939956092009751e01,
                    +1.5359450000390657e02,
                ],
            ],
            dtype=torch.float64,
        ),
        "disp2": torch.tensor(
            [
                -2.8788632548321321e-003,
                -6.3435979775151754e-004,
                -9.6167619562274962e-004,
                -7.9723260613915258e-004,
                -7.9238263177385578e-004,
                -7.4485995467369389e-004,
                -1.0311812354479540e-003,
                -1.0804678845482093e-003,
                -2.1424517331896948e-003,
                -5.3905710617330410e-004,
                -7.3549132878459982e-004,
                -2.9718856310496566e-003,
                -1.9053629060228276e-003,
                -1.8362475794413465e-003,
                -1.7182276597931356e-003,
                -4.2417715940356341e-003,
            ],
            dtype=torch.float64,
        ),
        "disp3": torch.tensor(
            [
                -2.8718125389999259e-003,
                -6.3328090446635918e-004,
                -9.5663711211542641e-004,
                -7.9370460692262154e-004,
                -7.9033697856002835e-004,
                -7.4037167668508294e-004,
                -1.0277787758263043e-003,
                -1.0733979636313967e-003,
                -2.1410728848939844e-003,
                -5.3484648487498051e-004,
                -7.3184554571681479e-004,
                -2.9622995709883419e-003,
                -1.9025657858451914e-003,
                -1.8324762672052280e-003,
                -1.7135582283322110e-003,
                -4.2406598201600847e-003,
            ],
            dtype=torch.float64,
        ),
    },
    "PbH4-BiH3": {
        "cn": torch.tensor(
            [
                3.9388208389,
                0.9832025766,
                0.9832026958,
                0.9832026958,
                0.9865897894,
                2.9714603424,
                0.9870455265,
                0.9870456457,
                0.9870455265,
            ],
            dtype=torch.float64,
        ),
        "weights": torch.tensor(
            [
                [1.107063e-27, 2.265990e-16, 1.057252e-07, 1.411678e-02, 9.858831e-01],
                [9.790892e-01, 2.091082e-02, 0.000000e-00, 0.000000e-00, 0.000000e-00],
                [9.790892e-01, 2.091080e-02, 0.000000e-00, 0.000000e-00, 0.000000e-00],
                [9.790892e-01, 2.091080e-02, 0.000000e-00, 0.000000e-00, 0.000000e-00],
                [9.795891e-01, 2.041091e-02, 0.000000e-00, 0.000000e-00, 0.000000e-00],
                [4.515681e-16, 1.310995e-07, 1.719178e-02, 9.828081e-01, 0.000000e-00],
                [9.796555e-01, 2.034455e-02, 0.000000e-00, 0.000000e-00, 0.000000e-00],
                [9.796555e-01, 2.034453e-02, 0.000000e-00, 0.000000e-00, 0.000000e-00],
                [9.796555e-01, 2.034455e-02, 0.000000e-00, 0.000000e-00, 0.000000e-00],
            ],
            dtype=torch.float64,
        ),
        "c6": torch.tensor(
            [
                [
                    456.209029,
                    37.274221,
                    37.274220,
                    37.274220,
                    37.263308,
                    493.665091,
                    37.261861,
                    37.261859,
                    37.261861,
                ],
                [
                    37.274221,
                    3.098765,
                    3.098765,
                    3.098765,
                    3.097897,
                    40.258369,
                    3.097782,
                    3.097782,
                    3.097782,
                ],
                [
                    37.274220,
                    3.098765,
                    3.098765,
                    3.098765,
                    3.097897,
                    40.258368,
                    3.097782,
                    3.097782,
                    3.097782,
                ],
                [
                    37.274220,
                    3.098765,
                    3.098765,
                    3.098765,
                    3.097897,
                    40.258368,
                    3.097782,
                    3.097782,
                    3.097782,
                ],
                [
                    37.263308,
                    3.097897,
                    3.097897,
                    3.097897,
                    3.097030,
                    40.246487,
                    3.096915,
                    3.096915,
                    3.096915,
                ],
                [
                    493.665091,
                    40.258369,
                    40.258368,
                    40.258368,
                    40.246487,
                    534.419974,
                    40.244911,
                    40.244910,
                    40.244911,
                ],
                [
                    37.261861,
                    3.097782,
                    3.097782,
                    3.097782,
                    3.096915,
                    40.244911,
                    3.096800,
                    3.096800,
                    3.096800,
                ],
                [
                    37.261859,
                    3.097782,
                    3.097782,
                    3.097782,
                    3.096915,
                    40.244910,
                    3.096800,
                    3.096800,
                    3.096800,
                ],
                [
                    37.261861,
                    3.097782,
                    3.097782,
                    3.097782,
                    3.096915,
                    40.244911,
                    3.096800,
                    3.096800,
                    3.096800,
                ],
            ],
            dtype=torch.float64,
        ),
        "disp2": torch.tensor(
            [
                -3.5479912602e-04,
                -8.9124281989e-05,
                -8.9124287363e-05,
                -8.9124287363e-05,
                -1.3686794039e-04,
                -3.8805575850e-04,
                -8.7387460069e-05,
                -8.7387464149e-05,
                -8.7387460069e-05,
            ],
            dtype=torch.float64,
        ),
        "disp3": torch.tensor(
            [],
            dtype=torch.float64,
        ),
    },
    "C6H5I-CH3SH": {
        "cn": torch.tensor(
            [
                3.1393690109,
                3.1313166618,
                3.1393768787,
                3.3153429031,
                3.1376547813,
                3.3148119450,
                1.5363609791,
                1.0035246611,
                1.0122337341,
                1.0036621094,
                1.0121959448,
                1.0036619902,
                2.1570565701,
                0.9981809855,
                3.9841127396,
                1.0146225691,
                1.0123561621,
                1.0085891485,
            ],
            dtype=torch.float64,
        ),
        "weights": torch.tensor(
            [
                [7.669145e-18, 9.045589e-09, 5.554739e-03, 9.361996e-01, 5.824569e-02],
                [9.333375e-18, 1.033050e-08, 5.943523e-03, 9.392180e-01, 5.483844e-02],
                [7.667672e-18, 9.044414e-09, 5.554371e-03, 9.361965e-01, 5.824912e-02],
                [9.612786e-20, 4.548463e-10, 1.160488e-03, 7.995832e-01, 1.992563e-01],
                [7.996743e-18, 9.305203e-09, 5.635430e-03, 9.368604e-01, 5.750420e-02],
                [9.744076e-20, 4.591300e-10, 1.166394e-03, 8.002455e-01, 1.985881e-01],
                [2.542048e-04, 9.997458e-01, 0.000000e-00, 0.000000e-00, 0.000000e-00],
                [9.819180e-01, 1.808196e-02, 0.000000e-00, 0.000000e-00, 0.000000e-00],
                [9.830121e-01, 1.698789e-02, 0.000000e-00, 0.000000e-00, 0.000000e-00],
                [9.819358e-01, 1.806416e-02, 0.000000e-00, 0.000000e-00, 0.000000e-00],
                [9.830075e-01, 1.699249e-02, 0.000000e-00, 0.000000e-00, 0.000000e-00],
                [9.819358e-01, 1.806418e-02, 0.000000e-00, 0.000000e-00, 0.000000e-00],
                [9.188072e-09, 5.005845e-03, 9.949941e-01, 0.000000e-00, 0.000000e-00],
                [9.812128e-01, 1.878718e-02, 0.000000e-00, 0.000000e-00, 0.000000e-00],
                [2.610153e-28, 2.424125e-16, 1.386950e-07, 2.015082e-02, 9.798490e-01],
                [9.833007e-01, 1.669934e-02, 0.000000e-00, 0.000000e-00, 0.000000e-00],
                [9.830270e-01, 1.697298e-02, 0.000000e-00, 0.000000e-00, 0.000000e-00],
                [9.825624e-01, 1.743759e-02, 0.000000e-00, 0.000000e-00, 0.000000e-00],
            ],
            dtype=torch.float64,
        ),
        "c6": torch.tensor(
            [
                [
                    25.308671,
                    25.323615,
                    25.308655,
                    24.710076,
                    25.311916,
                    24.712888,
                    94.892296,
                    8.828577,
                    8.823193,
                    8.828489,
                    8.823216,
                    8.828490,
                    56.245532,
                    8.832048,
                    21.436007,
                    8.821773,
                    8.823120,
                    8.825406,
                ],
                [
                    25.323615,
                    25.338571,
                    25.323599,
                    24.724560,
                    25.326863,
                    24.727374,
                    94.950852,
                    8.833831,
                    8.828443,
                    8.833743,
                    8.828466,
                    8.833744,
                    56.280052,
                    8.837304,
                    21.447970,
                    8.827023,
                    8.828370,
                    8.830658,
                ],
                [
                    25.308655,
                    25.323599,
                    25.308639,
                    24.710061,
                    25.311900,
                    24.712873,
                    94.892234,
                    8.828571,
                    8.823187,
                    8.828484,
                    8.823210,
                    8.828484,
                    56.245495,
                    8.832042,
                    21.435994,
                    8.821768,
                    8.823114,
                    8.825401,
                ],
                [
                    24.710076,
                    24.724560,
                    24.710061,
                    24.130008,
                    24.713222,
                    24.132733,
                    92.545041,
                    8.618185,
                    8.612959,
                    8.618100,
                    8.612981,
                    8.618100,
                    54.862146,
                    8.621554,
                    20.957466,
                    8.611582,
                    8.612888,
                    8.615108,
                ],
                [
                    25.311916,
                    25.326863,
                    25.311900,
                    24.713222,
                    25.315162,
                    24.716034,
                    94.905014,
                    8.829718,
                    8.824333,
                    8.829630,
                    8.824356,
                    8.829631,
                    56.253029,
                    8.833189,
                    21.438605,
                    8.822913,
                    8.824260,
                    8.826547,
                ],
                [
                    24.712888,
                    24.727374,
                    24.712873,
                    24.132733,
                    24.716034,
                    24.135458,
                    92.556069,
                    8.619173,
                    8.613947,
                    8.619088,
                    8.613969,
                    8.619089,
                    54.868645,
                    8.622542,
                    20.959714,
                    8.612569,
                    8.613876,
                    8.616096,
                ],
                [
                    94.892296,
                    94.950852,
                    94.892234,
                    92.545041,
                    94.905014,
                    92.556069,
                    358.497837,
                    33.161012,
                    33.140079,
                    33.160672,
                    33.140167,
                    33.160673,
                    212.283941,
                    33.174507,
                    79.702741,
                    33.134559,
                    33.139793,
                    33.148685,
                ],
                [
                    8.828577,
                    8.833831,
                    8.828571,
                    8.618185,
                    8.829718,
                    8.619173,
                    33.161012,
                    3.088957,
                    3.087062,
                    3.088926,
                    3.087070,
                    3.088926,
                    19.679250,
                    3.090178,
                    7.467556,
                    3.086563,
                    3.087036,
                    3.087841,
                ],
                [
                    8.823193,
                    8.828443,
                    8.823187,
                    8.612959,
                    8.824333,
                    8.613947,
                    33.140079,
                    3.087062,
                    3.085169,
                    3.087031,
                    3.085177,
                    3.087032,
                    19.666885,
                    3.088283,
                    7.463197,
                    3.084670,
                    3.085143,
                    3.085947,
                ],
                [
                    8.828489,
                    8.833743,
                    8.828484,
                    8.618100,
                    8.829630,
                    8.619088,
                    33.160672,
                    3.088926,
                    3.087031,
                    3.088895,
                    3.087039,
                    3.088895,
                    19.679050,
                    3.090148,
                    7.467485,
                    3.086532,
                    3.087006,
                    3.087810,
                ],
                [
                    8.823216,
                    8.828466,
                    8.823210,
                    8.612981,
                    8.824356,
                    8.613969,
                    33.140167,
                    3.087070,
                    3.085177,
                    3.087039,
                    3.085185,
                    3.087040,
                    19.666937,
                    3.088291,
                    7.463216,
                    3.084678,
                    3.085151,
                    3.085955,
                ],
                [
                    8.828490,
                    8.833744,
                    8.828484,
                    8.618100,
                    8.829631,
                    8.619089,
                    33.160673,
                    3.088926,
                    3.087032,
                    3.088895,
                    3.087040,
                    3.088896,
                    19.679050,
                    3.090148,
                    7.467485,
                    3.086532,
                    3.087006,
                    3.087811,
                ],
                [
                    56.245532,
                    56.280052,
                    56.245495,
                    54.862146,
                    56.253029,
                    54.868645,
                    212.283941,
                    19.679250,
                    19.666885,
                    19.679050,
                    19.666937,
                    19.679050,
                    125.836574,
                    19.687222,
                    47.294189,
                    19.663624,
                    19.666716,
                    19.671969,
                ],
                [
                    8.832048,
                    8.837304,
                    8.832042,
                    8.621554,
                    8.833189,
                    8.622542,
                    33.174507,
                    3.090178,
                    3.088283,
                    3.090148,
                    3.088291,
                    3.090148,
                    19.687222,
                    3.091400,
                    7.470366,
                    3.087783,
                    3.088257,
                    3.089062,
                ],
                [
                    21.436007,
                    21.447970,
                    21.435994,
                    20.957466,
                    21.438605,
                    20.959714,
                    79.702741,
                    7.467556,
                    7.463197,
                    7.467485,
                    7.463216,
                    7.467485,
                    47.294189,
                    7.470366,
                    18.341314,
                    7.462048,
                    7.463138,
                    7.464989,
                ],
                [
                    8.821773,
                    8.827023,
                    8.821768,
                    8.611582,
                    8.822913,
                    8.612569,
                    33.134559,
                    3.086563,
                    3.084670,
                    3.086532,
                    3.084678,
                    3.086532,
                    19.663624,
                    3.087783,
                    7.462048,
                    3.084171,
                    3.084644,
                    3.085448,
                ],
                [
                    8.823120,
                    8.828370,
                    8.823114,
                    8.612888,
                    8.824260,
                    8.613876,
                    33.139793,
                    3.087036,
                    3.085143,
                    3.087006,
                    3.085151,
                    3.087006,
                    19.666716,
                    3.088257,
                    7.463138,
                    3.084644,
                    3.085117,
                    3.085921,
                ],
                [
                    8.825406,
                    8.830658,
                    8.825401,
                    8.615108,
                    8.826547,
                    8.616096,
                    33.148685,
                    3.087841,
                    3.085947,
                    3.087810,
                    3.085955,
                    3.087811,
                    19.671969,
                    3.089062,
                    7.464989,
                    3.085448,
                    3.085921,
                    3.086726,
                ],
            ],
            dtype=torch.float64,
        ),
        "disp2": torch.tensor(
            [
                -4.1551151549e-04,
                -3.9770287009e-04,
                -4.1552470565e-04,
                -4.4246829733e-04,
                -4.7527776799e-04,
                -4.4258484762e-04,
                -1.0637547378e-03,
                -1.5452322970e-04,
                -1.9695663808e-04,
                -1.6184434935e-04,
                -1.9703176496e-04,
                -1.6183339573e-04,
                -4.6648977616e-04,
                -1.3764556692e-04,
                -2.4555353368e-04,
                -1.3535967638e-04,
                -1.5719227870e-04,
                -1.1675684940e-04,
            ],
            dtype=torch.float64,
        ),
        "disp3": torch.tensor(
            [],
            dtype=torch.float64,
        ),
    },
}

samples: dict[str, Record] = merge_nested_dicts(mols, refs)
